{
  "info": {
    "name": "FitHabs Exercise Upload API",
    "description": "Complete API collection for testing exercise creation with video and image uploads",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000/api/v1",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "workout_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Admin Login",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"admin@example.com\",\n  \"password\": \"admin123\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/admin-login",
          "host": ["{{base_url}}"],
          "path": ["admin-login"]
        },
        "description": "Login as admin to get authentication token"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    if (response.token) {",
              "        pm.collectionVariables.set('admin_token', response.token);",
              "        console.log('Admin token saved:', response.token);",
              "    }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "2. Create Workout",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Test Workout for Exercise Upload\",\n  \"description\": \"A test workout for testing exercise uploads with video and images\",\n  \"difficulty\": \"beginner\",\n  \"type\": \"full_body\",\n  \"duration_minutes\": 30,\n  \"created_by_admin\": true\n}"
        },
        "url": {
          "raw": "{{base_url}}/workouts",
          "host": ["{{base_url}}"],
          "path": ["workouts"]
        },
        "description": "Create a workout that will be used for exercise creation"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    if (response.data && response.data.id) {",
              "        pm.collectionVariables.set('workout_id', response.data.id);",
              "        console.log('Workout ID saved:', response.data.id);",
              "    }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "3. Debug Upload (Test Files)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          }
        ],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "video",
              "type": "file",
              "src": [],
              "description": "Select a video file (MP4, AVI, MOV, WMV, FLV, WebM) - Max 100MB"
            },
            {
              "key": "image",
              "type": "file",
              "src": [],
              "description": "Select an image file (JPEG, PNG, JPG, GIF, WebP) - Max 10MB"
            }
          ]
        },
        "url": {
          "raw": "{{base_url}}/exercises/debug-upload",
          "host": ["{{base_url}}"],
          "path": ["exercises", "debug-upload"]
        },
        "description": "Debug endpoint to test file uploads and check PHP configuration"
      }
    },
    {
      "name": "4. Create Exercise with Video and Image",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          }
        ],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "workout_id",
              "value": "{{workout_id}}",
              "type": "text",
              "description": "Workout ID from step 2"
            },
            {
              "key": "name",
              "value": "Test Exercise with Files",
              "type": "text",
              "description": "Exercise name"
            },
            {
              "key": "instructions",
              "value": "This is a test exercise for debugging upload functionality. Perform the exercise with proper form.",
              "type": "text",
              "description": "Exercise instructions"
            },
            {
              "key": "video",
              "type": "file",
              "src": [],
              "description": "Video file (MP4, AVI, MOV, WMV, FLV, WebM) - Max 100MB"
            },
            {
              "key": "image",
              "type": "file",
              "src": [],
              "description": "Image file (JPEG, PNG, JPG, GIF, WebP) - Max 10MB"
            },
            {
              "key": "duration_seconds",
              "value": "60",
              "type": "text",
              "description": "Duration in seconds"
            },
            {
              "key": "repetitions",
              "value": "10",
              "type": "text",
              "description": "Number of repetitions"
            },
            {
              "key": "sets",
              "value": "3",
              "type": "text",
              "description": "Number of sets"
            },
            {
              "key": "order",
              "value": "1",
              "type": "text",
              "description": "Order in workout"
            }
          ]
        },
        "url": {
          "raw": "{{base_url}}/exercises",
          "host": ["{{base_url}}"],
          "path": ["exercises"]
        },
        "description": "Create an exercise with video and image uploads"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 201) {",
              "    const response = pm.response.json();",
              "    if (response.status === 'success') {",
              "        console.log('Exercise created successfully!');",
              "        console.log('Image URL:', response.data.image_url);",
              "        console.log('Video URL:', response.data.video_url);",
              "        ",
              "        // Test if files are accessible",
              "        if (response.data.image_url) {",
              "            const imageUrl = pm.collectionVariables.get('base_url').replace('/api/v1', '') + response.data.image_url;",
              "            console.log('Full Image URL:', imageUrl);",
              "        }",
              "        if (response.data.video_url) {",
              "            const videoUrl = pm.collectionVariables.get('base_url').replace('/api/v1', '') + response.data.video_url;",
              "            console.log('Full Video URL:', videoUrl);",
              "        }",
              "    }",
              "} else {",
              "    console.log('Exercise creation failed:', pm.response.text());",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "5. Create Exercise with Video Only",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          }
        ],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "workout_id",
              "value": "{{workout_id}}",
              "type": "text"
            },
            {
              "key": "name",
              "value": "Exercise with Video Only",
              "type": "text"
            },
            {
              "key": "instructions",
              "value": "Exercise with only video file",
              "type": "text"
            },
            {
              "key": "video",
              "type": "file",
              "src": [],
              "description": "Video file only"
            },
            {
              "key": "duration_seconds",
              "value": "45",
              "type": "text"
            },
            {
              "key": "repetitions",
              "value": "15",
              "type": "text"
            },
            {
              "key": "sets",
              "value": "2",
              "type": "text"
            },
            {
              "key": "order",
              "value": "2",
              "type": "text"
            }
          ]
        },
        "url": {
          "raw": "{{base_url}}/exercises",
          "host": ["{{base_url}}"],
          "path": ["exercises"]
        },
        "description": "Create an exercise with only video file"
      }
    },
    {
      "name": "6. Create Exercise with Image Only",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          }
        ],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "workout_id",
              "value": "{{workout_id}}",
              "type": "text"
            },
            {
              "key": "name",
              "value": "Exercise with Image Only",
              "type": "text"
            },
            {
              "key": "instructions",
              "value": "Exercise with only image file",
              "type": "text"
            },
            {
              "key": "image",
              "type": "file",
              "src": [],
              "description": "Image file only"
            },
            {
              "key": "duration_seconds",
              "value": "30",
              "type": "text"
            },
            {
              "key": "repetitions",
              "value": "20",
              "type": "text"
            },
            {
              "key": "sets",
              "value": "1",
              "type": "text"
            },
            {
              "key": "order",
              "value": "3",
              "type": "text"
            }
          ]
        },
        "url": {
          "raw": "{{base_url}}/exercises",
          "host": ["{{base_url}}"],
          "path": ["exercises"]
        },
        "description": "Create an exercise with only image file"
      }
    },
    {
      "name": "7. Create Exercise without Files",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"workout_id\": \"{{workout_id}}\",\n  \"name\": \"Exercise without Files\",\n  \"instructions\": \"Exercise without any file uploads\",\n  \"duration_seconds\": 30,\n  \"repetitions\": 10,\n  \"sets\": 2,\n  \"order\": 4\n}"
        },
        "url": {
          "raw": "{{base_url}}/exercises",
          "host": ["{{base_url}}"],
          "path": ["exercises"]
        },
        "description": "Create an exercise without any file uploads"
      }
    },
    {
      "name": "8. Get Workout Exercises",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{admin_token}}"
          }
        ],
        "url": {
          "raw": "{{base_url}}/workouts/{{workout_id}}/exercises",
          "host": ["{{base_url}}"],
          "path": ["workouts", "{{workout_id}}", "exercises"]
        },
        "description": "Get all exercises for the created workout"
      }
    },
    {
      "name": "9. Test File Access (Image)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:8000/storage/exercises/images/exercise_1757941064_eaZ0yulB1F.jpg",
          "protocol": "http",
          "host": ["localhost"],
          "port": "8000",
          "path": ["storage", "exercises", "images", "exercise_1757941064_eaZ0yulB1F.jpg"]
        },
        "description": "Test if uploaded image file is accessible via HTTP"
      }
    },
    {
      "name": "10. Test File Access (Video)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:8000/storage/exercises/videos/exercise_1757941064_15RwYtYGZc.mp4",
          "protocol": "http",
          "host": ["localhost"],
          "port": "8000",
          "path": ["storage", "exercises", "videos", "exercise_1757941064_15RwYtYGZc.mp4"]
        },
        "description": "Test if uploaded video file is accessible via HTTP"
      }
    }
  ]
}
